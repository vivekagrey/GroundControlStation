<!DOCTYPE html>
<head>
   <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css" />
   <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.js"></script>

   <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
   <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

   <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

   <link rel="stylesheet" href="https://rawgit.com/lvoogdt/Leaflet.awesome-markers/2.0/develop/dist/leaflet.awesome-markers.css">
   <script src="https://rawgithub.com/lvoogdt/Leaflet.awesome-markers/2.0/develop/dist/leaflet.awesome-markers.js"></script>


   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/0.4.0/MarkerCluster.Default.css">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/0.4.0/MarkerCluster.css">
   <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/0.4.0/leaflet.markercluster-src.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/0.4.0/leaflet.markercluster.js"></script>

   <link rel="stylesheet" href="https://birdage.github.io/Leaflet.awesome-markers/dist/leaflet.awesome.rotate.css">

   
   
   
   

   <style>

      html, body {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
      }

      #map {
        position:absolute;
        top:0;
        bottom:0;
        right:0;
        left:0;
      }

   </style>
</head>

<body>

   <div class="folium-map" id="folium_8c214eb2bce443a8a50186a8cbf6d047" style="width: 100%; height: 100%"></div>

   <script>

      

      var base_tile = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
          maxZoom: 18,
          minZoom: 1,
          attribution: 'Map data (c) <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'
      });
             
    
            var tile_layer_d9965851aaa34d10be82096cf779b685 = L.tileLayer(
                "https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg",
                {"attribution": "Map tiles by \u003ca href=\"http://stamen.com\"\u003eStamen Design\u003c/a\u003e, under \u003ca href=\"http://creativecommons.org/licenses/by/3.0\"\u003eCC BY 3.0\u003c/a\u003e. Data by \u0026copy; \u003ca href=\"http://openstreetmap.org\"\u003eOpenStreetMap\u003c/a\u003e, under \u003ca href=\"http://creativecommons.org/licenses/by-sa/3.0\"\u003eCC BY SA\u003c/a\u003e.", "detectRetina": false, "maxNativeZoom": 18, "maxZoom": 18, "minZoom": 0, "noWrap": false, "opacity": 1, "subdomains": "abc", "tms": false}
            )
        
    
            var tile_layer_afc2dfe48c694ac18bb2815427c5f68f = L.tileLayer(
                "https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png",
                {"attribution": "\u0026copy; \u003ca href=\"http://www.openstreetmap.org/copyright\"\u003eOpenStreetMap\u003c/a\u003e contributors \u0026copy; \u003ca href=\"http://cartodb.com/attributions\"\u003eCartoDB\u003c/a\u003e, CartoDB \u003ca href =\"http://cartodb.com/attributions\"\u003eattributions\u003c/a\u003e", "detectRetina": false, "maxNativeZoom": 18, "maxZoom": 18, "minZoom": 0, "noWrap": false, "opacity": 1, "subdomains": "abc", "tms": false}
            )
        
    
            var tile_layer_488f4031c0f242928038c858768b0841 = L.tileLayer(
                "https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png",
                {"attribution": "\u0026copy; \u003ca href=\"http://www.openstreetmap.org/copyright\"\u003eOpenStreetMap\u003c/a\u003e contributors \u0026copy; \u003ca href=\"http://cartodb.com/attributions\"\u003eCartoDB\u003c/a\u003e, CartoDB \u003ca href =\"http://cartodb.com/attributions\"\u003eattributions\u003c/a\u003e", "detectRetina": false, "maxNativeZoom": 18, "maxZoom": 18, "minZoom": 0, "noWrap": false, "opacity": 1, "subdomains": "abc", "tms": false}
            )
        
    
            var tile_layer_c1ae22903e204c77852adce7a34ad8d3 = L.tileLayer(
                "https://stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}.png",
                {"attribution": "Map tiles by \u003ca href=\"http://stamen.com\"\u003eStamen Design\u003c/a\u003e, under \u003ca href=\"http://creativecommons.org/licenses/by/3.0\"\u003eCC BY 3.0\u003c/a\u003e. Data by \u0026copy; \u003ca href=\"http://openstreetmap.org\"\u003eOpenStreetMap\u003c/a\u003e, under \u003ca href=\"http://www.openstreetmap.org/copyright\"\u003eODbL\u003c/a\u003e.", "detectRetina": false, "maxNativeZoom": 18, "maxZoom": 18, "minZoom": 0, "noWrap": false, "opacity": 1, "subdomains": "abc", "tms": false}
            )
            

      var baseLayer = {
        "Open Street Map": base_tile,
        "Stamen Toner" : tile_layer_c1ae22903e204c77852adce7a34ad8d3,
        "Stamen Water Color" : tile_layer_d9965851aaa34d10be82096cf779b685,
        "Cartodb Positron" : tile_layer_afc2dfe48c694ac18bb2815427c5f68f,
        "Cartodb Dark Matter" : tile_layer_488f4031c0f242928038c858768b0841,

      };

      /*
      addition of the wms layers
      */

      

      /*
      addition of the tile layers
      */
      

      /*
      list of layers to be added//python_call_initialVehicleLocation(23,99);

      */
      var layer_list = {
                    
      
      };

      /*
      Bounding box.
      */
      var southWest = L.latLng(-90, -180),
          northEast = L.latLng(90, 180),
          bounds = L.latLngBounds(southWest, northEast);

      /*
      Creates the map and adds the selected layers
      */
      var map = L.map('folium_8c214eb2bce443a8a50186a8cbf6d047', {
                                       center:[28.5746070,77.4824165],
                                       zoom: 04,
                                       maxBounds: bounds,
                                       layers: [base_tile]
                                     });

var markers = [];
var uniqueId = 1;
var initialMarker;

function python_call_add(lat,lng)
{
   var new_mark = L.marker([lat, lng]).addTo(map);
   new_mark.id = uniqueId;
   markers.push(new_mark);
   //new_mark.dragging.enable();
   new_mark.on('dblclick', function(e){map.removeLayer(e.target);
      var wp = [0,e.latlng.lat,e.latlng.lng,new_mark.id];
   console.log(wp);})
   new_mark.bindPopup("Latitude: " + lat.toFixed(10) + "<br>Longitude: " + lng.toFixed(10));
   var wp = [1,lat,lng, new_mark.id];
   console.log(wp);
   uniqueId++;

}
function python_call_remove(id)
{
   for (var i = 0; i < markers.length; i++) {
            if (markers[i].id == id) {
                //Remove the marker from Map                  
                //markers[i].setMap(null);
               map.removeLayer(markers[i])
                //Remove the marker from array.
                //markers.splice(i, 1);
                return;
            }
         }
}
function python_call_initialVehicleLocation(newLat, newLng)
{  map.setZoom(18);                           
   map.panTo(L.latLng(newLat, newLng));
   initialMarker = L.circleMarker([newLat, newLng], {"bubblingMouseEvents": true, "color": "green", "dashArray": null, "dashOffset": null, "fill": true, "fillColor": "red", "fillOpacity": 1, "fillRule": "evenodd", "lineCap": "round", "lineJoin": "round", "opacity": 1.0, "radius": 3, "stroke": true, "weight": 3}
            ).addTo(map);
   
}
function python_call_newVehicleLocation(lat,lng)
{  
   var circle_marker = L.circleMarker([lat, lng], {"bubblingMouseEvents": true, "color": "green", "dashArray": null, "dashOffset": null, "fill": true, "fillColor": "red", "fillOpacity": 1, "fillRule": "evenodd", "lineCap": "round", "lineJoin": "round", "opacity": 1.0, "radius": 3, "stroke": true, "weight": 3}
            ).addTo(map);
   map.removeLayer(initialMarker)
   initialMarker = circle_marker;
}
function newMarker(e){
    var new_mark = L.marker().setLatLng(e.latlng).addTo(map);
    new_mark.id = uniqueId;
    markers.push(new_mark);
    //new_mark.dragging.enable();
    new_mark.on('dblclick', function(e){
       map.removeLayer(e.target);
       var wp = [0,e.latlng.lat,e.latlng.lng, new_mark.id];
       console.log(wp);})
    var lat = e.latlng.lat.toFixed(10),
       lng = e.latlng.lng.toFixed(10);
    new_mark.bindPopup("Latitude: " + lat + "<br>Longitude: " + lng );
    var wp = [1,e.latlng.lat,e.latlng.lng, new_mark.id];
    console.log(wp);
    uniqueId++;
};

map.on('click', newMarker)


      



   </script>

</body>